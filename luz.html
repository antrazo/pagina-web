
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Medidor de Luz</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background-color: #222;
    color: #fff;
    padding: 20px;
  }
  video {
    width: 300px;
    height: auto;
    border: 2px solid #444;
    border-radius: 8px;
    margin-top: 20px;
  }
  #brightness {
    font-size: 2em;
    margin-top: 20px;
    color: #ffcc00;
  }
</style>
</head>
<body>
<h1>Medidor de Luz</h1>
<p>Permite acceso a la cámara para medir el nivel de luz.</p>
<video id="video" autoplay playsinline></video>
<div id="brightness">Brillo: 0</div>

<script>
const video = document.getElementById('video');
const brightnessEl = document.getElementById('brightness');

// Solicitar acceso a la cámara
navigator.mediaDevices.getUserMedia({ video: true })
  .then(stream => {
    video.srcObject = stream;
    medirBrillo();
  })
  .catch(err => {
    alert('No se pudo acceder a la cámara: ' + err);
  });

function medirBrillo() {
  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d');
  canvas.width = 100;
  canvas.height = 100;

  setInterval(() => {
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    const frame = ctx.getImageData(0, 0, canvas.width, canvas.height);
    let total = 0;
    for (let i = 0; i < frame.data.length; i += 4) {
      // Promedio de R, G, B
      const r = frame.data[i];
      const g = frame.data[i + 1];
      const b = frame.data[i + 2];
      total += (r + g + b) / 3;
    }
    const avgBrightness = Math.round(total / (frame.data.length / 4));
    brightnessEl.textContent = `Brillo: ${avgBrightness}`;
  }, 500);
}
</script>
</body>
</html>
